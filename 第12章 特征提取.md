##### 第十二章，特征提取

> 区域分割后，下一步，通常是特征提取。
> 
> 特征提取：特征检测+特征描述

- 特征检测
  
  > 在图像，区域， 边界内，找到特征

- 特征描述
  
  > 对检测到的特征，分配量化属性

> 例如，在一个区域内，检测到一个角，然后使用角的朝向/位置，来描述这个角。
> 
> 输出是对图像信息的描述，即是一个感知

> 特征描述，应该尽量对比例 / 平移 / 旋转 / 照明 / 视角 等方面的差异不敏感。
> 
> 类似于 CNN 中的平移不变性

- 特征

> 最简单的特征例子，RGB 图像中的每个像素的三个颜色值，就是这个像素的三个特征描绘值。

- 边缘跟踪
  
  > 1. 找大最左上角的边界点，即为 p
  > 
  > 2. 以 p 为中心，按顺时针，找邻近的的边界点。找到的边界点重新积为 p
  > 
  > 3. 重复步骤2， 直到回到一开始的最左上角的点，则跟踪结束
  > 
  > --
  > 
  > 因为已访问过的点，允许再次访问，故第三步，必然可以回到最开始的起始点。外轮廓像素点只访问一次或两次，至多访问二次。

##### 链码

> 起始位置 + 边界点的方向编码 -> 边界。这种方法，称为链码
> 
> 4 或 8 联通编码的边缘，被称为 Freeman 链码

- 链码，一种无损压缩方法。

- 边界平移，链码不会改变。仅仅改变起始位置。

- 对边缘重新采样，得到重采样后的链码
  
  > 好处：
  > 
  > - 链码长度更小
  > 
  > - 不受噪音和细节轮廓的影响，容易获取全局的结构
  > 
  > - 可消去结构尺寸的缩放的影响

- 重新采样
  
  > 个人理解：在曲线上取点，映射到最邻近的粗网格的图像上。通过投票方式，决定曲线在粗网格的图像上的表示。 

- 最小值归一化
  
  > 对`链码` / `链码的差分码`，整数序列视为一个大整数值，通过循环移动数字序列，得到一个所表示的整数最小的序列。这个称为最小值归一。
  > 
  > 同一个边界，仅仅起点不同，得到的链码不同，做最小值归一后，链码相同。

- 链码的差分编码
  
  > 同一个边界，同一个起始点，发生旋转，得到的链码不同。
  > 
  > 只记录链码的前后由差异的数据，即只记录方向的变化，而不记录方向本身。
  > 
  > 由于不考虑方向本身，故**4链码的90度旋转（8链码的45度）的整数倍**旋转，都不会影响链码的差分码，差分码相同。
  > 
  > 相当于做旋转归一化：即在旋转这个维度，做标准化对齐，之后不再需要考虑上述旋转问题。

##### 斜链码

> 线段长度+边界的旋转角度 -> 边界。
> 
> 这种方法称为斜链码。

- 和链码比的优势：
  
  > - 无需基于网格
  > 
  > - 角度更加细，不限于4或8个方向

- 线段等长时，可以视为同半径圆，在遍历曲线

- 不保证遍历能回到最开始的位置
  
  > 因为有小数+三角函数计算，结果不精确。
  > 
  > 在整数坐标系上，则还需要做取整。

##### 最小周长多边形，做边界近似

1. 将边界映射到格子图像上

2. 利用像素区域的凹点，凸点，计算边界的最小周长多边形

> 相较于像素级的链码，可以有效压缩数据量，并且保持较好的形状特征。

##### 签名

> 签名，是一种数据压缩，把数据压缩成一个身份标识。

- 将2维边界，映射到1维空间
  
  > 例如，将质心到边界点的距离，作为数据点，形成1维数据，作为2维边界的签名。

##### 骨架

- 区域 -> 骨架
  
  > 即 区域 -> 图
  > 
  > 区域的骨架到区域的边界距离相等

- 获取骨架方法
  
  > - 形态腐蚀：保留端点并保留联通性。
  >   
  >   > 见 9.5 章
  > 
  > - 中轴变换

##### 中轴变换，找区域骨架

> 区域 R 的边界是B，在 R 中每个点 p, 若点 p 到边界 B 的距离最近点有两个或多个，则 p 属于中轴

>  距离采用欧几里德距离，则获得的骨骼和 9.5 章 maximum disks 方法一样。

> 细化，中轴变换，都容易收到内部和边界的不规则的影响。
> 
> 故通常需要平滑的预处理

- 距离变换
  
  > 前景：1
  > 
  > 背景：0
  > 
  > 距离变换，指每个像素到非0像素的距离
  > 
  > 输出是一个图像
  
  > 由于目标是找到前景区域的骨架。
  > 
  > 所以，先对图像做补，即前景0，背景1
  > 
  > 再做距离变换
  
  - 距离变化，可以在线性时间内完成。O(K)
  
  对比：
  
  > 细化：实现简单，计算量小，但是有毛刺，需要处理
  > 
  > 距离变换：骨骼效果好，但是计算量大

##### 边界特征描述子

- 长轴
  
  > 边界的半径的长度和朝向，称为边界的主线。
  > 
  > 其中边界的半径，指边界上距离最远的两个点的距离。
  > 
  > 边界的朝向，指这两个点组成的线段的朝向。

- 短轴
  
  > 方向与长轴垂直
  > 
  > 距离：与长轴组成的矩形框，恰好可以框住整个区域。
  > 
  > 这个框，也叫边界框， Bounding Box
  
  > 长轴 / 短轴 = 边界的偏心率

- 斜率变化
  
  > 基于斜链码 slope chain code, 可以轻易实现斜率变化的描述。
  > 
  > 例如，曲折度，tortuosity, 将 SCC 中的斜率变化的绝对值，做累加即可。
  > 
  > $$
  > \tau = \sum_{i = 1}^{n}|a_{i}|
  > $$
  > 
  > 其中 $a_{i}$ 是 SCC 中的斜率变化值

- 形状编号
  
  > 即对边界做链码，再做差分，再做最小值归一化，得到的一个数字序列，视为这个形状的编号
  
  - 形状编号的数字个数，称为此编号的阶
    
    > 故闭环边界的编号的阶，必为偶数
  
  - 过程
  
  > 1. 形状边界 $\to$ 长轴/短轴，即边界框
  > 
  > 2. 编号的阶 n + 边界框 $\to$ 网格图像
  > 
  > 3. 边界 + 网格图像 $\to$ 网格图像中坐标
  > 
  > 4. 坐标值转形状编号：坐标 $\to$ 链码 $\to$ 差分码 $\to$ 最小值归一化，即形状编号

##### 傅里叶描述子

过程：

1. 把图像上的点(x, y)，视为一个复数点 x + jy。

> 则将二维数据，转为一维数据。
> 
> $$
> s(k) = x(k) + jy(k)
> $$
> 
> 其中 x(k), y(k) 分别是第 k 个边界点的横坐标和纵坐标。

2. 把边界点序列，视为一个复数函数 s(k)

3. 做傅里叶变化，得边界序列在频率空间的表示
   
   > $s(k) \to a(u) $
   > 
   > 其中 u 是频率，$a(u)$ 是边界在频域空间的表示，关于频率的函数
   > 
   > $a(u)$ 的系数，被称为傅里叶描述子

4. 对频域空间的函数$a(u)$ 做一次高频过滤
   
   > 即只 $a(u)$ 保留前面p 项，即最低频的 p 项，后续高频项过滤掉。
   > 
   > 即对图像做了一次平滑。
   > 
   > 等价于空间域的低通过滤器。

5. 逆傅里叶变化
   
   > $a(u) \to s(k) $

> 总结：
> 
> 1. 相当于对图像做平滑
> 
> 2. 即使保留很少的低频项，仍然能保留形状的大致轮廓。例如只使用 1% 的低频项，即可。
> 
> // 有需要，再细读 zyp.

##### 霍夫变换，Hough Transform

> 从图像中，识别直线的高效方法

##### SIFT. 2004

> 用于检测，描述，匹配图像的局部特征

大致过程：

1. 从图像集合中，提取物体的特征点，并存储到数据库中

2. 提取输入图像中的物体的特征x 

3. 根据 x, 在数据库中找最接近的特征集合 s

4. 根据输入图像的物体位置，尺寸，朝向，从s 中过滤出最好的匹配子集合
   
   > 利用广义霍夫变化 (GHT) 来实现

> 具体实现，比较复杂。有需要，再研究。 zyp.
